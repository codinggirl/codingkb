---
title: 2的副本
created: '2019-09-04T01:42:48.295Z'
modified: '2019-09-20T07:54:31.681Z'
---

# 高效设置网络图片

计算机读取数据时：内存的读取速度是最快的，然后是文件的读取速度，最后是网络资源的读取。

如果每次加载同一张图片都要从网络获取，那代价实在太大了。所以同一张图片只要从网络获取一次就够了，然后在本地缓存起来，之后加载同一张图片时就 从缓存中加载就可以了。 从内存缓存读取图片是最快的，但是因为Android对每个应用所能使用的内存容量都有限制，所以最好再加上文件缓存。文件缓存空间也不是无限大的，容量越大读取效率越低。因此我们常设置一个限定大小。

加载图片的流程应该是： 1、先从内存缓存中获取，取到则返回，取不到则进行下一步； 2、从文件缓存中获取，取到则返回并更新到内存缓存，取不到则进行下一步； 3、从网络下载图片，并更新到内存缓存和文件缓存。

①比如我们想指定图片的大小，虽然我们可以通过设置view的固定宽高来强制图片的显示大小，但如果是一张几兆的图片，而我们只需要15*15分辨率大小的显示区域，这显然是浪费的；

②又比如，我们希望控件在网络正在下载图片时先显示一个默认的图片（比如一个灰色的头像）又或者是图片下载的时候显示一个环形的进度条，那么上面的代码是没有办法的；

③再比如，我们希望图片的下载方式有多种，对于不同网站来源有不同的下载方式。。。。

。那么为了控件的完备性与可扩展性，我们就需要一个配置器、一个显示器、一个下载器。。等等根据特殊需要而添加的插件式开发。


通过这个配置器，我们就可以动态的对每一张下载的图片设置宽高、以及内存大小等。而I\_ImageLoder、I\_Display则是两个协议接口，分别定义了下载器和显示器的方法，这里实际上是GoF设计模式中工厂方法模式的应用，只是这里的工厂实际上并不是用来创建对象，而是用来定义显示方法或下载方法的，不论是哪个实现了I\_ImageLoder抽象工厂的实际工厂，都必须有一个加载图片的方法。那么在项目的实际应用中，就可以不管这个下载器的实际工厂是什么，只需要调用工厂的加载图片的方法就行了。

## 参考资料

- [https://kymjs.com/code/2014/07/25/01](https://kymjs.com/code/2014/07/25/01)

