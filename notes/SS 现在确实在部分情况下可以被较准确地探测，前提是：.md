---
title: SS 现在确实在部分情况下可以被较准确地探测，前提是：
created: '2019-09-11T03:43:50.594Z'
modified: '2019-09-11T03:43:54.507Z'
---

SS 现在确实在部分情况下可以被较准确地探测，前提是：

1. 使用了 RC4 、AES-256-* 类型的流加密方式，加密之后前 16 字节为随机生成的 IV，第 17 字节表示通过 SS 的协议类型（1 - IPv4，3 - DNS，4 - IPv6），紧跟着从 18 字节开始表示目的地址，长度不定。
2. 没有开启 SS 的 AutoBan 功能，防火墙没有做其他类型的尝试数量限制。

SS Server 端的特性是，如果解密之后的明文在第 17 字节位置上的值不是（1、3、4）中的一个，那么就立马断开连接，否则就继续运行对后面的目的地址进行连接和请求。

而 breakwa11 给出的测探 SS Server 的方法并不是要破解整个密文，而是构造特定密文给 SS Server 去解密，并观察响应。前面 16 字节随便构造，这段密文总可以解密成功，虽然这里的明文完全没有办法知道是啥，不过也不需要知道就是了。根据流加密的特性，遍历 17 字节位置上的所有情况，总有解密之后为（1、3、4）中的某一个的，这时的 SS Server 不会立马断开，而是去解密 18 字节位置开始的目的地址，这样通过 SS Server 的响应差别便可以完成测探。

第一次测探确认成功之后会进行第二次测探，修改 18 字节位置（即：目的地址），虽然这里没办法之后解密之后的目的地址是什么，但是目前 IPv4 基本上全被占用的情况下（假设），即使修改目的地址仍然可以建立连接，如果第二次也不是马上断开，那么就能够确定是运行着 SS Server。

这个探测方法确实是可以成功探测到特殊情况下 SS Server 的存在，不过感觉意义不大，有点像鸡蛋里头挑骨头的做法。而且这也不是 SS 的错，只能说是这类型加密算法的特性，SS 本来就是一个加密协议这样做也没什么有问题的地方。

同时可以发现，breakwa11 在这个 comment 里也有提到，chacha20 这类使用 8 字节 IV 的加密更少被探测，因为默认的 AES-256-* 是 16 字节 IV，而 GFW 主要探测的为 16 字节 IV，所以换成 chacha20 往往 SS 速度会得到提升，因为绕过了部分区域的 QoS。（但并不是这种不能被探测，根据上面的做法修改第 10 位开始的目的地址就行了）


